<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Kinect Dance Battle</title>
  <style>
    :root {
      --p1-color: #ff0055;
      --p2-color: #00f2ff;
      --bg-dark: #05050a;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      background: var(--bg-dark);
      color: #fff;
      font-family: 'Inter', 'Segoe UI', system-ui, sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
      overflow: hidden;
    }

    /* CRT Scanline Overlay */
    body::before {
      content: " ";
      position: fixed;
      top: 0; left: 0; bottom: 0; right: 0;
      background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), 
                  linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
      background-size: 100% 4px, 3px 100%;
      pointer-events: none;
      z-index: 10;
    }

    .main-container {
      width: 100%;
      max-width: 500px;
      position: relative;
      z-index: 2;
    }

    .header-group {
      text-align: center;
      margin-bottom: 50px;
      transform: skewY(-2deg);
    }

    .logo {
      font-size: clamp(32px, 8vw, 54px);
      font-weight: 900;
      font-style: italic;
      line-height: 1;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 3px 3px 0px var(--p1-color), -3px -3px 0px var(--p2-color);
      letter-spacing: -2px;
    }

    .battle-grid {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .player-section {
      position: relative;
      background: #111;
      padding: 5px;
      clip-path: polygon(0 0, 95% 0, 100% 25%, 100% 100%, 5% 100%, 0 75%);
    }

    .player-section.p1 { border-left: 8px solid var(--p1-color); }
    .player-section.p2 { border-right: 8px solid var(--p2-color); }

    .inner-card {
      background: #1a1a24;
      padding: 20px;
      clip-path: polygon(0 0, 95% 0, 100% 25%, 100% 100%, 5% 100%, 0 75%);
    }

    .tag {
      font-size: 10px;
      font-weight: 900;
      text-transform: uppercase;
      margin-bottom: 8px;
      display: block;
    }
    .p1 .tag { color: var(--p1-color); }
    .p2 .tag { color: var(--p2-color); text-align: right; }

    .name-input {
      width: 100%;
      background: transparent;
      border: none;
      border-bottom: 2px solid rgba(255,255,255,0.1);
      font-family: 'Courier New', monospace;
      font-size: 24px;
      color: #fff;
      padding: 10px 0;
      outline: none;
      transition: all 0.3s;
    }

    .p1 .name-input:focus { border-color: var(--p1-color); }
    .p2 .name-input:focus { border-color: var(--p2-color); text-align: right; }

    .btn-group {
      margin-top: 40px;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .start-btn {
      background: #fff;
      color: #000;
      border: none;
      padding: 20px;
      font-size: 22px;
      font-weight: 900;
      text-transform: uppercase;
      cursor: pointer;
      clip-path: polygon(5% 0, 100% 0, 95% 100%, 0% 100%);
      transition: transform 0.1s, background 0.3s;
    }

    .start-btn:hover { background: var(--p2-color); color: #000; }
    .start-btn:active { transform: scale(0.95) skewX(-5deg); }

    .reset-btn {
      background: transparent;
      border: 1px solid rgba(255,255,255,0.2);
      color: rgba(255,255,255,0.5);
      padding: 10px;
      font-weight: 700;
      text-transform: uppercase;
      cursor: pointer;
      font-size: 12px;
      letter-spacing: 2px;
    }

    .status-area {
      margin-top: 30px;
      font-family: monospace;
      text-align: center;
      color: #555;
      text-transform: uppercase;
    }

    .status-area.success { color: #00ff88; text-shadow: 0 0 10px #00ff88; }
    .status-area.error { color: #ff0055; }

    @keyframes glitch {
      0% { transform: translate(0); }
      20% { transform: translate(-2px, 2px); }
      40% { transform: translate(-2px, -2px); }
      60% { transform: translate(2px, 2px); }
      80% { transform: translate(2px, -2px); }
      100% { transform: translate(0); }
    }
    .logo:hover { animation: glitch 0.3s infinite; }
  </style>
</head>
<body>

  <div class="main-container">
    <div class="header-group">
      <div class="logo">Kinect Dance<br>Battle</div>
    </div>

    <div class="battle-grid">
      <div class="player-section p1">
        <div class="inner-card">
          <span class="tag">Challenger 01</span>
          <input class="name-input" id="p1name" type="text" placeholder="PLAYER 1" maxlength="15">
        </div>
      </div>

      <div class="player-section p2">
        <div class="inner-card">
          <span class="tag">Challenger 02</span>
          <input class="name-input" id="p2name" type="text" placeholder="PLAYER 2" maxlength="15">
        </div>
      </div>
    </div>

    <div class="btn-group">
      <button class="start-btn" id="startBtn" onclick="submitNames()">Submit</button>
      <button class="reset-btn" onclick="resetNames()">Clear</button>
    </div>

    <div class="status-area" id="status">
      System Ready // Standing By
    </div>
  </div>

  <script>
    const p1 = document.getElementById('p1name');
    const p2 = document.getElementById('p2name');
    const statusEl = document.getElementById('status');

    // Load existing names
    fetch('/names').then(r => r.json()).then(data => {
      if (data.player1) p1.value = data.player1;
      if (data.player2) p2.value = data.player2;
    }).catch(() => {});

    async function submitNames() {
      const name1 = p1.value.trim();
      const name2 = p2.value.trim();
      
      if (!name1 && !name2) {
        showStatus('!! INPUT REQUIRED !!', 'error');
        return;
      }

      showStatus('SENDING...', '');
      
      try {
        const res = await fetch('/names', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ player1: name1, player2: name2 })
        });

        if (res.ok) {
          showStatus('âœ“ SUBMITTED SUCCESSFULLY', 'success');
          // Clear inputs after success
          p1.value = '';
          p2.value = '';
        } else {
          showStatus('!! SERVER ERROR !!', 'error');
        }
      } catch (err) {
        showStatus('!! CONNECTION LOST !!', 'error');
      }
    }

    async function resetNames() {
      try {
        await fetch('/reset', { method: 'POST' });
        p1.value = ''; 
        p2.value = '';
        showStatus('SYSTEM CLEARED', '');
      } catch { 
        showStatus('CLEAR FAILED', 'error'); 
      }
    }

    function showStatus(msg, type) {
      statusEl.innerHTML = msg;
      statusEl.className = 'status-area ' + type;
    }
  </script>
</body>
</html>
