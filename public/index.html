<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Kinect Dance — Player Setup</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      background: #0a0a0f;
      color: #fff;
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 40px 24px;
      background-image:
        radial-gradient(ellipse at 20% 20%, rgba(120, 40, 200, 0.15) 0%, transparent 60%),
        radial-gradient(ellipse at 80% 80%, rgba(0, 180, 255, 0.1) 0%, transparent 60%);
    }

    .logo {
      font-size: 48px;
      font-weight: 900;
      letter-spacing: 6px;
      text-transform: uppercase;
      background: linear-gradient(135deg, #c850c0, #4158d0, #00c3ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 8px;
      text-align: center;
    }

    .subtitle {
      font-size: 16px;
      color: rgba(255,255,255,0.4);
      letter-spacing: 3px;
      text-transform: uppercase;
      margin-bottom: 48px;
      text-align: center;
    }

    .players {
      display: flex;
      flex-direction: column;
      gap: 28px;
      width: 100%;
      max-width: 480px;
    }

    .player-card {
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 20px;
      padding: 28px;
      backdrop-filter: blur(10px);
    }

    .player-card.p1 { border-color: rgba(200, 80, 192, 0.3); }
    .player-card.p2 { border-color: rgba(0, 195, 255, 0.3); }

    .player-label {
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 3px;
      text-transform: uppercase;
      margin-bottom: 16px;
    }
    .p1 .player-label { color: #c850c0; }
    .p2 .player-label { color: #00c3ff; }

    .name-input {
      width: 100%;
      background: rgba(255,255,255,0.06);
      border: 1.5px solid rgba(255,255,255,0.12);
      border-radius: 12px;
      padding: 18px 20px;
      font-size: 28px;
      font-weight: 600;
      color: #fff;
      outline: none;
      transition: border-color 0.2s, background 0.2s;
      -webkit-appearance: none;
    }

    .name-input::placeholder { color: rgba(255,255,255,0.2); }

    .p1 .name-input:focus { border-color: #c850c0; background: rgba(200,80,192,0.08); }
    .p2 .name-input:focus { border-color: #00c3ff; background: rgba(0,195,255,0.08); }

    .start-btn {
      width: 100%;
      max-width: 480px;
      margin-top: 36px;
      padding: 22px;
      background: linear-gradient(135deg, #c850c0, #4158d0);
      border: none;
      border-radius: 16px;
      color: #fff;
      font-size: 20px;
      font-weight: 800;
      letter-spacing: 3px;
      text-transform: uppercase;
      cursor: pointer;
      transition: transform 0.15s, opacity 0.15s;
      -webkit-tap-highlight-color: transparent;
    }

    .start-btn:active { transform: scale(0.97); opacity: 0.85; }
    .start-btn:disabled { opacity: 0.4; cursor: not-allowed; transform: none; }

    .reset-btn {
      width: 100%;
      max-width: 480px;
      margin-top: 14px;
      padding: 16px;
      background: transparent;
      border: 1.5px solid rgba(255,255,255,0.15);
      border-radius: 14px;
      color: rgba(255,255,255,0.4);
      font-size: 14px;
      font-weight: 600;
      letter-spacing: 2px;
      text-transform: uppercase;
      cursor: pointer;
      transition: border-color 0.2s, color 0.2s;
      -webkit-tap-highlight-color: transparent;
    }

    .reset-btn:active { border-color: rgba(255,255,255,0.4); color: rgba(255,255,255,0.7); }

    .status {
      margin-top: 24px;
      font-size: 14px;
      letter-spacing: 1px;
      color: rgba(255,255,255,0.35);
      text-align: center;
      min-height: 24px;
      transition: color 0.3s;
    }

    .status.success { color: #4ade80; }
    .status.error { color: #f87171; }

    .dot {
      display: inline-block;
      width: 8px; height: 8px;
      border-radius: 50%;
      background: #4ade80;
      margin-right: 8px;
      vertical-align: middle;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }
  </style>
</head>
<body>

  <div class="logo">INFINITE</div>
  <div class="subtitle">2026 &nbsp;·&nbsp; Player Setup</div>

  <div class="players">
    <div class="player-card p1">
      <div class="player-label">Player 1</div>
      <input class="name-input" id="p1name" type="text"
             placeholder="Enter name..." maxlength="20"
             autocomplete="off" autocorrect="off" autocapitalize="words" spellcheck="false">
    </div>

    <div class="player-card p2">
      <div class="player-label">Player 2</div>
      <input class="name-input" id="p2name" type="text"
             placeholder="Enter name..." maxlength="20"
             autocomplete="off" autocorrect="off" autocapitalize="words" spellcheck="false">
    </div>
  </div>

  <button class="start-btn" id="startBtn" onclick="submitNames()">
    START GAME
  </button>

  <button class="reset-btn" onclick="resetNames()">
    Reset Names
  </button>

  <div class="status" id="status">
    <span class="dot"></span> Ready
  </div>

  <script>
    const p1 = document.getElementById('p1name');
    const p2 = document.getElementById('p2name');
    const statusEl = document.getElementById('status');

    // Load any existing names from server on page load
    fetch('/names')
      .then(r => r.json())
      .then(data => {
        if (data.player1) p1.value = data.player1;
        if (data.player2) p2.value = data.player2;
      })
      .catch(() => {});

    // Submit on Enter key from either input
    p1.addEventListener('keydown', e => { if (e.key === 'Enter') p2.focus(); });
    p2.addEventListener('keydown', e => { if (e.key === 'Enter') submitNames(); });

    async function submitNames() {
      const name1 = p1.value.trim();
      const name2 = p2.value.trim();

      if (!name1 && !name2) {
        showStatus('Enter at least one name', 'error');
        return;
      }

      const btn = document.getElementById('startBtn');
      btn.disabled = true;
      showStatus('Sending...', '');

      try {
        const res = await fetch('/names', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ player1: name1, player2: name2 })
        });

        if (res.ok) {
          showStatus(`✓ ${name1 || 'Player 1'} & ${name2 || 'Player 2'} — Game starting!`, 'success');
        } else {
          showStatus('Server error — try again', 'error');
        }
      } catch (err) {
        showStatus('Connection failed — check network', 'error');
      } finally {
        btn.disabled = false;
      }
    }

    async function resetNames() {
      try {
        await fetch('/reset', { method: 'POST' });
        p1.value = '';
        p2.value = '';
        showStatus('Names cleared', '');
        setTimeout(() => showStatus('<span class="dot"></span> Ready', ''), 2000);
      } catch {
        showStatus('Reset failed', 'error');
      }
    }

    function showStatus(msg, type) {
      statusEl.innerHTML = msg;
      statusEl.className = 'status ' + type;
    }
  </script>
</body>
</html>
